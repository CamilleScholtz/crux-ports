# Description: Monero: the secure, private, untraceable currency.
# URL:         https://getmonero.org/
# Maintainer:  onodera, https://github.com/onodera-punpun/crux-ports/issues
# Depends on:  boost cppzmq libunbound

name=monero
version=0.13.0.4
release=0
source=(
	https://github.com/$name-project/$name/archive/v$version.tar.gz
	https://github.com/$name-project/miniupnp/archive/6b9b73a.zip
	https://github.com/Tencent/rapidjson/archive/129d19b.zip
	monerod.conf
	monerod
)

build() {
	cd $name-$version

	mv $SRC/miniupnp-6b9b73a*/* external/miniupnp
	mv $SRC/rapidjson-129d19b*/* external/rapidjson

	cmake . \
		-DCMAKE_BUILD_TYPE=Release \
		-DCMAKE_INSTALL_PREFIX=/usr

	make

	mkdir -p $PKG/usr/bin
	install -m755 -t $PKG/usr/bin bin/*
	install -Dm755 $SRC/monerod.conf $PKG/etc/monerod.conf
	install -Dm755 $SRC/monerod $PKG/etc/rc.d/monerod
}
